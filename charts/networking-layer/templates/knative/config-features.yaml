{{- if .Values.knative.enabled }}
# Knative feature flags for LLM inference workloads
# Enables terminationGracePeriodSeconds which is blocked by default
apiVersion: v1
kind: ConfigMap
metadata:
  name: config-features
  namespace: knative-serving
  labels:
    {{- include "networking-layer.labels" . | nindent 4 }}
    app.kubernetes.io/component: features
data:
  # Enable terminationGracePeriodSeconds on Knative Services
  # Required for graceful shutdown of long-running LLM inference requests
  # Without this, InferenceService with terminationGracePeriodSeconds will fail validation
  kubernetes.podspec-terminationGracePeriodSeconds: {{ .Values.knative.features.terminationGracePeriodSeconds | quote }}
{{- end }}
